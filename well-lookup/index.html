<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Well Depth Lookup - California Groundwater</title>
    <meta name="description" content="Search 75,000+ California well records to find typical well depths in your area. Free tool for homeowners planning a new well in San Diego, Riverside, or San Bernardino counties.">
    <link rel="canonical" href="https://california-groundwater.org/well-lookup/">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #333;
            line-height: 1.5;
        }
        a { color: #2563eb; text-decoration: none; }
        
        /* Header */
        .site-header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: white;
            padding: 15px 20px;
        }
        .site-header-inner {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .site-logo {
            font-size: 1.2rem;
            font-weight: 700;
            color: white;
        }
        .site-logo span { color: #60a5fa; }
        .site-nav a {
            color: rgba(255,255,255,0.9);
            margin-left: 20px;
            font-size: 0.9rem;
        }
        
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 12px;
        }
        header h1 { font-size: 1.8rem; margin-bottom: 8px; }
        header p { opacity: 0.9; font-size: 1rem; }
        .data-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 12px;
        }
        .search-box {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        .search-box label { display: block; margin-bottom: 8px; font-weight: 600; }
        .search-row { display: flex; gap: 10px; }
        .search-box input[type="text"] {
            flex: 1;
            padding: 14px 18px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
        }
        .search-box input:focus { outline: none; border-color: #2563eb; }
        .search-box button {
            padding: 14px 28px;
            font-size: 16px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        .search-box button:hover { background: #1d4ed8; }
        .search-box button:disabled { background: #94a3b8; cursor: not-allowed; }
        .options { display: flex; gap: 20px; margin-top: 15px; flex-wrap: wrap; }
        .options label { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: #64748b; }
        .options select { padding: 6px 12px; border-radius: 6px; border: 1px solid #e2e8f0; }
        .tip { margin-top: 12px; font-size: 0.85rem; color: #64748b; background: #f1f5f9; padding: 10px 15px; border-radius: 8px; }
        .loading { text-align: center; padding: 40px; color: #64748b; }
        .error { background: #fef2f2; border: 1px solid #fecaca; color: #dc2626; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .stats-box { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); margin-bottom: 20px; }
        .stats-box h2 { font-size: 1.2rem; margin-bottom: 15px; color: #1e3a5f; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; }
        .stat-item { text-align: center; padding: 18px; background: #f8fafc; border-radius: 8px; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: #1e3a5f; }
        .stat-label { font-size: 0.8rem; color: #64748b; margin-top: 4px; }
        .estimate-box { background: linear-gradient(135deg, #1e3a5f, #2d5a87); color: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; }
        .estimate-box h3 { margin-bottom: 10px; }
        .estimate-range { font-size: 2rem; font-weight: 700; margin-bottom: 10px; }
        .estimate-note { font-size: 0.9rem; opacity: 0.85; }
        .wells-list { background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); overflow: hidden; }
        .wells-list h3 { padding: 18px 20px; border-bottom: 1px solid #e2e8f0; font-size: 1rem; color: #1e3a5f; background: #f8fafc; }
        .well-card { padding: 18px 20px; border-bottom: 1px solid #f1f5f9; }
        .well-card:last-child { border-bottom: none; }
        .well-card .header { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .well-card .depth { font-size: 1.3rem; font-weight: 700; color: #1e3a5f; }
        .well-card .distance { font-size: 0.85rem; color: #64748b; background: #f1f5f9; padding: 4px 10px; border-radius: 12px; }
        .well-card .details { font-size: 0.9rem; color: #64748b; }
        .well-card .details span { display: inline-block; margin-right: 15px; }
        .cta-box { background: #16a34a; color: white; padding: 25px; border-radius: 12px; text-align: center; margin-top: 20px; }
        .cta-box h3 { margin-bottom: 8px; }
        .cta-box p { opacity: 0.9; margin-bottom: 15px; }
        .cta-box a { display: inline-block; background: white; color: #16a34a; padding: 12px 28px; border-radius: 8px; text-decoration: none; font-weight: 600; }
        .cta-box a:hover { background: #f0fdf4; }
        
        .back-link { margin-bottom: 20px; }
        .back-link a { color: #64748b; font-size: 0.9rem; }
        
        footer { text-align: center; padding: 30px 20px; color: #64748b; font-size: 0.85rem; }
        footer a { color: #2563eb; }
        
        @media (max-width: 600px) {
            .search-row { flex-direction: column; }
            .stats-grid { grid-template-columns: 1fr 1fr; }
            .site-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="site-header">
        <div class="site-header-inner">
            <a href="/" class="site-logo">üíß California<span>Groundwater</span></a>
            <nav class="site-nav">
                <a href="/well-lookup/">Well Lookup</a>
                <a href="/pump-calculator/">Pump Calculator</a>
                <a href="/contractors/">Contractors</a>
            </nav>
        </div>
    </div>
    
    <div class="container">
        <div class="back-link"><a href="/">‚Üê Back to Home</a></div>
        
        <header>
            <h1>üîç Well Depth Lookup</h1>
            <p>Search 75,000+ California well completion records</p>
            <div class="data-badge" id="dataBadge">Loading data...</div>
        </header>
        
        <div class="search-box">
            <label for="address">Enter Your Property Address</label>
            <div class="search-row">
                <input type="text" id="address" placeholder="123 Main St, Ramona, CA 92065" autocomplete="off">
                <button id="searchBtn" onclick="search()" disabled>Loading...</button>
            </div>
            <div class="tip">üí° <strong>Tip:</strong> Include your <strong>zip code</strong> for best results. Well depths can vary significantly even within a few miles.</div>
            <div class="options">
                <label>Search Radius: <select id="radius">
                    <option value="0.5" selected>0.5 miles</option>
                    <option value="1">1 mile</option>
                    <option value="2">2 miles</option>
                    <option value="5">5 miles</option>
                </select></label>
            </div>
        </div>
        
        <div id="loading" class="loading" style="display: none;">Searching wells...</div>
        <div id="error" class="error" style="display: none;"></div>
        <div id="results" style="display: none;"></div>
    </div>
    
    <footer>
        <p>Data sourced from <a href="https://water.ca.gov/" target="_blank">California Department of Water Resources</a> well completion reports.</p>
        <p style="margin-top: 8px;">¬© 2026 <a href="/">California Groundwater</a> | A project by <a href="https://www.scwellservice.com" target="_blank">Southern California Well Service</a></p>
    </footer>

    <script>
        const NOMINATIM_API = 'https://nominatim.openstreetmap.org/search';
        let LOCAL_WELLS = null;
        
        async function loadLocalData() {
            try {
                const resp = await fetch('well_data.json');
                const data = await resp.json();
                LOCAL_WELLS = data.wells;
                document.getElementById('dataBadge').textContent = `‚úì ${data.count.toLocaleString()} wells loaded`;
                document.getElementById('searchBtn').disabled = false;
                document.getElementById('searchBtn').textContent = 'Search';
            } catch (e) {
                document.getElementById('dataBadge').textContent = '‚ö† Data failed to load';
                document.getElementById('searchBtn').textContent = 'Search';
                document.getElementById('searchBtn').disabled = false;
            }
        }
        loadLocalData();
        
        document.getElementById('address').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') search();
        });
        
        async function search() {
            const address = document.getElementById('address').value.trim();
            if (!address) { showError('Please enter an address'); return; }
            if (!LOCAL_WELLS) { showError('Well data is still loading. Please wait.'); return; }
            
            showLoading(true);
            hideError();
            hideResults();
            
            try {
                const coords = await geocode(address);
                const currentRadius = parseFloat(document.getElementById('radius').value);
                const wells = queryLocalWells(coords.lat, coords.lon, currentRadius);
                const analysis = analyzeWells(wells, coords.lat, coords.lon);
                analysis.location = coords.display;
                analysis.coords = coords;
                analysis.radius = currentRadius;
                analysis.fallback = coords.fallback;
                showResults(analysis);
            } catch (err) {
                showError(err.message);
            } finally {
                showLoading(false);
            }
        }
        
        async function geocode(address) {
            const params = new URLSearchParams({ q: address, format: 'json', limit: 1, countrycodes: 'us' });
            const resp = await fetch(`${NOMINATIM_API}?${params}`, { headers: { 'User-Agent': 'CaliforniaGroundwater/1.0' } });
            let data = await resp.json();
            let fallback = false;
            
            if (!data.length) {
                const allZips = address.match(/\b\d{5}\b/g);
                const zipCode = allZips ? allZips[allZips.length - 1] : null;
                if (zipCode) {
                    const zipParams = new URLSearchParams({ q: zipCode, format: 'json', limit: 1, countrycodes: 'us' });
                    const zipResp = await fetch(`${NOMINATIM_API}?${zipParams}`, { headers: { 'User-Agent': 'CaliforniaGroundwater/1.0' } });
                    data = await zipResp.json();
                    if (data.length) fallback = true;
                }
            }
            
            if (!data.length) {
                const knownCities = ['ramona', 'aguanga', 'escondido', 'valley center', 'fallbrook', 'temecula', 
                    'murrieta', 'poway', 'alpine', 'jamul', 'descanso', 'julian', 'borrego springs',
                    'hemet', 'winchester', 'anza', 'idyllwild', 'lake elsinore', 'wildomar',
                    'apple valley', 'lucerne valley', 'hesperia', 'victorville', 'yucca valley',
                    'twentynine palms', 'joshua tree', 'morongo valley', 'pioneertown',
                    'perris', 'menifee', 'san jacinto', 'banning', 'beaumont', 'cherry valley'];
                const lowerAddr = address.toLowerCase();
                for (const city of knownCities) {
                    if (lowerAddr.includes(city)) {
                        const cityParams = new URLSearchParams({ q: `${city}, CA`, format: 'json', limit: 1, countrycodes: 'us' });
                        const cityResp = await fetch(`${NOMINATIM_API}?${cityParams}`, { headers: { 'User-Agent': 'CaliforniaGroundwater/1.0' } });
                        data = await cityResp.json();
                        if (data.length) { fallback = true; break; }
                    }
                }
            }
            
            if (!data.length) throw new Error('Could not find that location. Try adding your zip code.');
            if (fallback) document.getElementById('radius').value = '2';
            return { lat: parseFloat(data[0].lat), lon: parseFloat(data[0].lon), display: data[0].display_name, fallback };
        }
        
        function queryLocalWells(lat, lon, radiusMiles) {
            if (!LOCAL_WELLS) return [];
            return LOCAL_WELLS.filter(w => calcDistance(lat, lon, w.lat, w.lon) <= radiusMiles)
                .map(w => ({ TotalCompletedDepth: w.depth, DecimalLatitude: w.lat, DecimalLongitude: w.lon, City: w.city, WellYield: w.yield, CasingDiameter: w.casing, WCRNumber: w.wcr, DrillingMethod: w.method }));
        }
        
        function calcDistance(lat1, lon1, lat2, lon2) {
            const R = 3959;
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180) * Math.cos(lat2*Math.PI/180) * Math.sin(dLon/2)**2;
            return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        }
        
        function analyzeWells(wells, centerLat, centerLon) {
            if (!wells.length) return { wells: [], stats: null };
            wells.forEach(w => { w._distance = calcDistance(centerLat, centerLon, w.DecimalLatitude, w.DecimalLongitude); w._depth = w.TotalCompletedDepth; });
            wells.sort((a, b) => a._distance - b._distance);
            
            const wellsWithDepth = wells.filter(w => w._depth > 0);
            const yields = wells.map(w => w.WellYield).filter(y => y > 0);
            
            let weightedDepth = null;
            if (wellsWithDepth.length) {
                let totalWeight = 0, weightedSum = 0;
                wellsWithDepth.forEach(w => { const weight = 1 / Math.pow(w._distance + 0.1, 2); weightedSum += w._depth * weight; totalWeight += weight; });
                weightedDepth = Math.round(weightedSum / totalWeight);
            }
            const depths = wellsWithDepth.map(w => w._depth);
            
            return {
                wells: wells.slice(0, 20),
                stats: {
                    count: wells.length,
                    avgDepth: weightedDepth,
                    minDepth: depths.length ? Math.min(...depths) : null,
                    maxDepth: depths.length ? Math.max(...depths) : null,
                    avgYield: yields.length ? Math.round(yields.reduce((a,b)=>a+b,0)/yields.length) : null
                }
            };
        }
        
        function showResults(analysis) {
            const { wells, stats, radius, fallback } = analysis;
            const resultsDiv = document.getElementById('results');
            
            if (!wells.length) {
                resultsDiv.innerHTML = `<div class="stats-box"><p>No wells found within ${radius} mile(s). Try increasing the search radius.</p></div>`;
                resultsDiv.style.display = 'block';
                return;
            }
            
            const costLow = stats.avgDepth * 50;
            const costHigh = stats.avgDepth * 80;
            
            resultsDiv.innerHTML = `
                <div class="stats-box">
                    <h2>üìä Well Data for This Area</h2>
                    ${fallback ? '<p style="margin-bottom:12px;color:#b45309;font-size:0.85rem;background:#fef3c7;padding:10px 15px;border-radius:8px;">‚ö†Ô∏è Exact address not found ‚Äî showing results for general area.</p>' : ''}
                    <p style="margin-bottom:15px;color:#64748b;font-size:0.9rem;">Based on ${stats.count} wells within ${radius} mile(s)</p>
                    <div class="stats-grid">
                        <div class="stat-item"><div class="stat-value">${stats.avgDepth}'</div><div class="stat-label">Avg Depth</div></div>
                        <div class="stat-item"><div class="stat-value">${stats.minDepth}'-${stats.maxDepth}'</div><div class="stat-label">Range</div></div>
                        <div class="stat-item"><div class="stat-value">${stats.avgYield || 'N/A'}</div><div class="stat-label">Avg GPM</div></div>
                    </div>
                </div>
                <div class="estimate-box">
                    <h3>üí∞ Estimated Drilling Cost</h3>
                    <div class="estimate-range">$${costLow.toLocaleString()} - $${costHigh.toLocaleString()}</div>
                    <div class="estimate-note">Based on ${stats.avgDepth}' average depth √ó $50-80/foot. Actual costs vary.</div>
                </div>
                <div class="wells-list">
                    <h3>üîç Nearby Wells (${wells.length} shown)</h3>
                    ${wells.map(w => `
                        <div class="well-card">
                            <div class="header">
                                <span class="depth">${w.TotalCompletedDepth}' deep</span>
                                <span class="distance">${w._distance.toFixed(2)} mi</span>
                            </div>
                            <div class="details">
                                ${w.City ? `<span>üìç ${w.City}</span>` : ''}
                                ${w.DrillingMethod ? `<span>üîß ${w.DrillingMethod}</span>` : ''}
                                ${w.WellYield ? `<span>üíß ${w.WellYield} GPM</span>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="cta-box">
                    <h3>Need a Professional Quote?</h3>
                    <p>This estimate is based on nearby well data. Contact a licensed contractor for a site assessment.</p>
                    <a href="/contractors/">Find a Contractor ‚Üí</a>
                </div>
            `;
            resultsDiv.style.display = 'block';
        }
        
        function showLoading(show) { document.getElementById('loading').style.display = show ? 'block' : 'none'; }
        function showError(msg) { const el = document.getElementById('error'); el.textContent = msg; el.style.display = 'block'; }
        function hideError() { document.getElementById('error').style.display = 'none'; }
        function hideResults() { document.getElementById('results').style.display = 'none'; }
    </script>
</body>
</html>
